"use strict";(self.webpackChunkshaozongfan_website=self.webpackChunkshaozongfan_website||[]).push([[3806],{3905:function(e,n,t){t.d(n,{Zo:function(){return u},kt:function(){return p}});var r=t(67294);function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function d(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){s(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function a(e,n){if(null==e)return{};var t,r,s=function(e,n){if(null==e)return{};var t,r,s={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(s[t]=e[t]);return s}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var c=r.createContext({}),o=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):d(d({},n),e)),t},u=function(e){var n=o(e.components);return r.createElement(c.Provider,{value:n},e.children)},v={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},l=r.forwardRef((function(e,n){var t=e.components,s=e.mdxType,i=e.originalType,c=e.parentName,u=a(e,["components","mdxType","originalType","parentName"]),l=o(t),p=s,_=l["".concat(c,".").concat(p)]||l[p]||v[p]||i;return t?r.createElement(_,d(d({ref:n},u),{},{components:t})):r.createElement(_,d({ref:n},u))}));function p(e,n){var t=arguments,s=n&&n.mdxType;if("string"==typeof e||s){var i=t.length,d=new Array(i);d[0]=l;var a={};for(var c in n)hasOwnProperty.call(n,c)&&(a[c]=n[c]);a.originalType=e,a.mdxType="string"==typeof e?e:s,d[1]=a;for(var o=2;o<i;o++)d[o]=t[o];return r.createElement.apply(null,d)}return r.createElement.apply(null,t)}l.displayName="MDXCreateElement"},71631:function(e,n,t){t.r(n),t.d(n,{assets:function(){return u},contentTitle:function(){return c},default:function(){return p},frontMatter:function(){return a},metadata:function(){return o},toc:function(){return v}});var r=t(87462),s=t(63366),i=(t(67294),t(3905)),d=["components"],a={},c="5.4.1\u3000udev\u4e0edevfs\u7684\u533a\u522b",o={unversionedId:"linux\u8bbe\u5907\u9a71\u52a8\u5f00\u53d1\u8be6\u89e3/5.4\u3000udev\u7528\u6237\u7a7a\u95f4\u8bbe\u5907\u7ba1\u7406",id:"linux\u8bbe\u5907\u9a71\u52a8\u5f00\u53d1\u8be6\u89e3/5.4\u3000udev\u7528\u6237\u7a7a\u95f4\u8bbe\u5907\u7ba1\u7406",title:"5.4.1\u3000udev\u4e0edevfs\u7684\u533a\u522b",description:"\u5c3d\u7ba1devfs\u6709\u8fd9\u6837\u548c\u90a3\u6837\u7684\u4f18\u70b9\uff0c\u4f46\u662f\uff0c\u5728Linux 2.6\u5185\u6838\u4e2d\uff0cdevfs\u88ab\u8ba4\u4e3a\u662f\u8fc7\u65f6\u7684\u65b9\u6cd5\uff0c\u5e76\u6700\u7ec8\u88ab\u629b\u5f03\u4e86\uff0cudev\u53d6\u4ee3\u4e86\u5b83\u3002Linux VFS\u5185\u6838\u7ef4\u62a4\u8005Al Viro\u6307\u51fa\u4e86\u51e0\u70b9udev\u53d6\u4ee3devfs\u7684\u539f\u56e0\uff1a",source:"@site/docs/linux\u8bbe\u5907\u9a71\u52a8\u5f00\u53d1\u8be6\u89e3/5.4\u3000udev\u7528\u6237\u7a7a\u95f4\u8bbe\u5907\u7ba1\u7406.md",sourceDirName:"linux\u8bbe\u5907\u9a71\u52a8\u5f00\u53d1\u8be6\u89e3",slug:"/linux\u8bbe\u5907\u9a71\u52a8\u5f00\u53d1\u8be6\u89e3/5.4\u3000udev\u7528\u6237\u7a7a\u95f4\u8bbe\u5907\u7ba1\u7406",permalink:"/docs/linux\u8bbe\u5907\u9a71\u52a8\u5f00\u53d1\u8be6\u89e3/5.4\u3000udev\u7528\u6237\u7a7a\u95f4\u8bbe\u5907\u7ba1\u7406",draft:!1,editUrl:"https://github.com/shaozongfan/shaozongfan.github.io/docs/linux\u8bbe\u5907\u9a71\u52a8\u5f00\u53d1\u8be6\u89e3/5.4\u3000udev\u7528\u6237\u7a7a\u95f4\u8bbe\u5907\u7ba1\u7406.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"5.3\u3000devfs",permalink:"/docs/linux\u8bbe\u5907\u9a71\u52a8\u5f00\u53d1\u8be6\u89e3/5.3\u3000devfs"},next:{title:"6.1.1\u3000cdev\u7ed3\u6784\u4f53",permalink:"/docs/linux\u8bbe\u5907\u9a71\u52a8\u5f00\u53d1\u8be6\u89e3/6.1\u3000Linux\u5b57\u7b26\u8bbe\u5907\u9a71\u52a8\u7ed3\u6784"}},u={},v=[],l={toc:v};function p(e){var n=e.components,a=(0,s.Z)(e,d);return(0,i.kt)("wrapper",(0,r.Z)({},l,a,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"541udev\u4e0edevfs\u7684\u533a\u522b"},"5.4.1\u3000udev\u4e0edevfs\u7684\u533a\u522b"),(0,i.kt)("p",null,"\u5c3d\u7ba1devfs\u6709\u8fd9\u6837\u548c\u90a3\u6837\u7684\u4f18\u70b9\uff0c\u4f46\u662f\uff0c\u5728Linux 2.6\u5185\u6838\u4e2d\uff0cdevfs\u88ab\u8ba4\u4e3a\u662f\u8fc7\u65f6\u7684\u65b9\u6cd5\uff0c\u5e76\u6700\u7ec8\u88ab\u629b\u5f03\u4e86\uff0cudev\u53d6\u4ee3\u4e86\u5b83\u3002Linux VFS\u5185\u6838\u7ef4\u62a4\u8005Al Viro\u6307\u51fa\u4e86\u51e0\u70b9udev\u53d6\u4ee3devfs\u7684\u539f\u56e0\uff1a"),(0,i.kt)("p",null,"1\uff09devfs\u6240\u505a\u7684\u5de5\u4f5c\u88ab\u786e\u4fe1\u53ef\u4ee5\u5728\u7528\u6237\u6001\u6765\u5b8c\u6210\u3002"),(0,i.kt)("p",null,"2\uff09devfs\u88ab\u52a0\u5165\u5185\u6838\u4e4b\u65f6\uff0c\u5927\u5bb6\u671f\u671b\u5b83\u7684\u8d28\u91cf\u53ef\u4ee5\u8fce\u5934\u8d76\u4e0a\u3002"),(0,i.kt)("p",null,"3\uff09\u53d1\u73b0devfs\u6709\u4e00\u4e9b\u53ef\u4fee\u590d\u548c\u65e0\u6cd5\u4fee\u590d\u7684bug\u3002"),(0,i.kt)("p",null,"4\uff09\u5bf9\u4e8e\u53ef\u4fee\u590d\u7684bug\uff0c\u51e0\u4e2a\u6708\u524d\u5c31\u5df2\u7ecf\u88ab\u4fee\u590d\u4e86\uff0c\u5176\u7ef4\u62a4\u8005\u8ba4\u4e3a\u4e00\u5207\u826f\u597d\u3002"),(0,i.kt)("p",null,"5\uff09\u5bf9\u4e8e\u540e\u8005\uff0c\u5728\u76f8\u5f53\u957f\u7684\u4e00\u6bb5\u65f6\u95f4\u5185\u6ca1\u6709\u6539\u89c2\u3002"),(0,i.kt)("p",null,"6\uff09devfs\u7684\u7ef4\u62a4\u8005\u548c\u4f5c\u8005\u5bf9\u5b83\u611f\u5230\u5931\u671b\u5e76\u4e14\u5df2\u7ecf\u505c\u6b62\u4e86\u5bf9\u4ee3\u7801\u7684\u7ef4\u62a4\u5de5\u4f5c\u3002"),(0,i.kt)("p",null,"Linux\u5185\u6838\u7684\u4e24\u4f4d\u8d21\u732e\u8005\uff0cRichard Gooch\uff08devfs\u7684\u4f5c\u8005\uff09\u548cGreg Kroah-Hartman\uff08sysfs\u7684\u4e3b\u8981\u4f5c\u8005\uff09\u5c31devfs/udev\u8fdb\u884c\u4e86\u6fc0\u70c8\u7684\u4e89\u8bba\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Greg\uff1aRichard had stated that udev was a proper replacement for devfs.\nRichard\uff1aWell\uff0cthat's news to me\uff01\nGreg\uff1adevfs should be taken out because policy should exist in userspace and not in the kernel.\nRichard\uff1asysfs\uff0cdeveloped in large part by Greg\uff0calso implemented policy in the kernel.\nGreg\uff1adevfs was broken and unfixable\nRichard\uff1aNo proof.Never say never...\n\u8fd9\u6bb5\u6709\u8da3\u7684\u4e89\u8bba\u53ef\u610f\u8bd1\u5982\u4e0b\uff1a\nGreg\uff1aRichard\u5df2\u7ecf\u6307\u51fa\uff0cudev\u662fdevfs\u5408\u9002\u7684\u66ff\u4ee3\u54c1\u3002\nRichard\uff1a\u54e6\uff0c\u6211\u600e\u4e48\u4e0d\u77e5\u9053\uff1f\nGreg\uff1adevfs\u5e94\u8be5\u4e0b\u8bfe\uff0c\u56e0\u4e3a\u7b56\u7565\u5e94\u8be5\u4f4d\u4e8e\u7528\u6237\u7a7a\u95f4\u800c\u4e0d\u662f\u5185\u6838\u7a7a\u95f4\u3002\nRichard\uff1a\u54e6\uff0c\u7531Greg\u5b8c\u6210\u5927\u90e8\u5206\u5de5\u4f5c\u7684sysfs\u4e5f\u5728\u5185\u6838\u4e2d\u5b9e\u73b0\u4e86\u7b56\u7565\u3002\nGreg\uff1adevfs\u5f88\u8e69\u811a\uff0c\u4e5f\u4e0d\u7a33\u5b9a\u3002\nRichard\uff1a\u5475\u5475\uff0c\u6ca1\u8bc1\u636e\uff0c\u522b\u90a3\u4e48\u6b66\u65ad\u2026\u2026\n")),(0,i.kt)("p",null,"\u5728Richard Gooch\u548cGreg Kroah-Hartman\u7684\u4e89\u8bba\u4e2d\uff0cGreg Kroah-Hartman\u4f7f\u7528\u7684\u7406\u8bba\u4f9d\u636e\u5c31\u5728\u4e8epolicy\uff08\u7b56\u7565\uff09\u4e0d\u80fd\u4f4d\u4e8e\u5185\u6838\u7a7a\u95f4\u4e2d\u3002Linux\u8bbe\u8ba1\u4e2d\u5f3a\u8c03\u7684\u4e00\u4e2a\u57fa\u672c\u89c2\u70b9\u662f\u673a\u5236\u548c\u7b56\u7565\u7684\u5206\u79bb\u3002\u673a\u5236\u662f\u505a\u67d0\u6837\u4e8b\u60c5\u7684\u56fa\u5b9a\u6b65\u9aa4\u3001\u65b9\u6cd5\uff0c\u800c\u7b56\u7565\u5c31\u662f\u6bcf\u4e00\u4e2a\u6b65\u9aa4\u6240\u91c7\u53d6\u7684\u4e0d\u540c\u65b9\u5f0f\u3002\u673a\u5236\u662f\u76f8\u5bf9\u56fa\u5b9a\u7684\uff0c\u800c\u6bcf\u4e2a\u6b65\u9aa4\u91c7\u7528\u7684\u7b56\u7565\u662f\u4e0d\u56fa\u5b9a\u7684\u3002\u673a\u5236\u662f\u7a33\u5b9a\u7684\uff0c\u800c\u7b56\u7565\u5219\u662f\u7075\u6d3b\u7684\uff0c\u56e0\u6b64\uff0c\u5728Linux\u5185\u6838\u4e2d\uff0c\u4e0d\u5e94\u8be5\u5b9e\u73b0\u7b56\u7565\u3002"),(0,i.kt)("p",null,"\u6bd4\u5982Linux\u63d0\u4f9bAPI\u53ef\u4ee5\u8ba9\u4eba\u628a\u7ebf\u7a0b\u7684\u4f18\u5148\u7ea7\u8c03\u9ad8\u6216\u8005\u8c03\u4f4e\uff0c\u6216\u8005\u8c03\u6574\u8c03\u5ea6\u7b56\u7565\u4e3aSCHED_FIFO\u4ec0\u4e48\u7684\uff0c\u4f46\u662fLinux\u5185\u6838\u672c\u8eab\u5374\u4e0d\u7ba1\u8c01\u9ad8\u8c01\u4f4e\u3002\u63d0\u4f9bAPI\u5c5e\u4e8e\u673a\u5236\uff0c\u8c01\u9ad8\u8c01\u4f4e\u8fd9\u5c5e\u4e8e\u7b56\u7565\uff0c\u6240\u4ee5\u5e94\u8be5\u662f\u5e94\u7528\u7a0b\u5e8f\u81ea\u5df1\u53bb\u544a\u8bc9\u5185\u6838\u8981\u9ad8\u6216\u4f4e\uff0c\u800c\u5185\u6838\u4e0d\u7ba1\u8fd9\u4e9b\u6742\u4e8b\u3002\u540c\u7406\uff0cGreg Kroah-Hartman\u8ba4\u4e3a\uff0c\u5c5e\u4e8e\u7b56\u7565\u7684\u4e1c\u897f\u5e94\u8be5\u88ab\u79fb\u5230\u7528\u6237\u7a7a\u95f4\u4e2d\uff0c\u8c01\u7231\u7ed9\u54ea\u4e2a\u8bbe\u5907\u521b\u5efa\u4ec0\u4e48\u540d\u5b57\u6216\u8005\u60f3\u505a\u66f4\u591a\u7684\u5904\u7406\uff0c\u8c01\u81ea\u5df1\u53bb\u8bbe\u5b9a\u3002\u5185\u6838\u53ea\u7ba1\u628a\u8fd9\u4e9b\u4fe1\u606f\u544a\u8bc9\u7528\u6237\u5c31\u884c\u4e86\u3002\u8fd9\u5c31\u662f\u4f4d\u4e8e\u5185\u6838\u7a7a\u95f4\u7684devfs\u5e94\u8be5\u88ab\u4f4d\u4e8e\u7528\u6237\u7a7a\u95f4\u7684udev\u53d6\u4ee3\u7684\u539f\u56e0\uff0c\u5e94\u8be5devfs\u7ba1\u4e86\u4e00\u4e9b\u4e0d\u9760\u8c31\u7684\u4e8b\u60c5\u3002"),(0,i.kt)("p",null,"\u4e0b\u9762\u4e3e\u4e00\u4e2a\u901a\u4fd7\u7684\u4f8b\u5b50\u6765\u7406\u89e3udev\u8bbe\u8ba1\u7684\u51fa\u53d1\u70b9\u3002\u4ee5\u8c08\u604b\u7231\u4e3a\u4f8b\uff0cGreg Kroah-Hartman\u8ba4\u4e3a\uff0c\u53ef\u4ee5\u8ba9\u5185\u6838\u63d0\u4f9b\u8c08\u604b\u7231\u7684\u673a\u5236\uff0c\u4f46\u662f\u4e0d\u80fd\u5728\u5185\u6838\u7a7a\u95f4\u4e2d\u9650\u5236\u8ddf\u8c01\u8c08\u604b\u7231\uff0c\u4e0d\u80fd\u628a\u8c08\u604b\u7231\u7684\u7b56\u7565\u653e\u5728\u5185\u6838\u7a7a\u95f4\u3002\u56e0\u4e3a\u604b\u7231\u662f\u81ea\u7531\u7684\uff0c\u7528\u6237\u5e94\u8be5\u53ef\u4ee5\u5728\u7528\u6237\u7a7a\u95f4\u4e2d\u5b9e\u73b0\u201c\u841d\u535c\u767d\u83dc\uff0c\u5404\u6709\u6240\u7231\u201d\u7684\u7406\u60f3\uff0c\u53ef\u4ee5\u6839\u636e\u5bf9\u65b9\u7684\u5916\u8c8c\u3001\u7c4d\u8d2f\u3001\u6027\u683c\u7b49\u81ea\u7531\u9009\u62e9\u3002\u5bf9\u5e94devfs\u800c\u8a00\uff0c\u7b2c1\u4e2a\u76f8\u4eb2\u7684\u5973\u5b69\u88ab\u547d\u540d\u4e3a/dev/girl0\uff0c\u7b2c2\u4e2a\u76f8\u4eb2\u7684\u5973\u5b69\u88ab\u547d\u540d\u4e3a/dev/girl1\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\u800c\u5728\u7528\u6237\u7a7a\u95f4\u5b9e\u73b0\u7684udev\u5219\u53ef\u4ee5\u4f7f\u5f97\u7528\u6237\u5b9e\u73b0\u8fd9\u6837\u7684\u81ea\u7531\uff1a\u4e0d\u7ba1\u4f60\u4e2d\u610f\u7684\u5973\u5b69\u662f\u7b2c\u51e0\u4e2a\uff0c\u53ea\u8981\u5b83\u4e0e\u4f60\u5b9a\u4e49\u7684\u89c4\u5219\u7b26\u5408\uff0c\u90fd\u547d\u540d\u4e3a/dev/mygirl\uff01"),(0,i.kt)("p",null,"udev\u5b8c\u5168\u5728\u7528\u6237\u6001\u5de5\u4f5c\uff0c\u5229\u7528\u8bbe\u5907\u52a0\u5165\u6216\u79fb\u9664\u65f6\u5185\u6838\u6240\u53d1\u9001\u7684\u70ed\u63d2\u62d4\u4e8b\u4ef6\uff08Hotplug Event\uff09\u6765\u5de5\u4f5c\u3002\u5728\u70ed\u63d2\u62d4\u65f6\uff0c\u8bbe\u5907\u7684\u8be6\u7ec6\u4fe1\u606f\u4f1a\u7531\u5185\u6838\u901a\u8fc7netlink\u5957\u63a5\u5b57\u53d1\u9001\u51fa\u6765\uff0c\u53d1\u51fa\u7684\u4e8b\u60c5\u53ebuevent\u3002udev\u7684\u8bbe\u5907\u547d\u540d\u7b56\u7565\u3001\u6743\u9650\u63a7\u5236\u548c\u4e8b\u4ef6\u5904\u7406\u90fd\u662f\u5728\u7528\u6237\u6001\u4e0b\u5b8c\u6210\u7684\uff0c\u5b83\u5229\u7528\u4ece\u5185\u6838\u6536\u5230\u7684\u4fe1\u606f\u6765\u8fdb\u884c\u521b\u5efa\u8bbe\u5907\u6587\u4ef6\u8282\u70b9\u7b49\u5de5\u4f5c\u3002\u4ee3\u7801\u6e05\u53555.6\u7ed9\u51fa\u4e86\u4ece\u5185\u6838\u901a\u8fc7netlink\u63a5\u6536\u70ed\u63d2\u62d4\u4e8b\u4ef6\u5e76\u51b2\u5237\u6389\u7684\u8303\u4f8b\uff0cudev\u91c7\u7528\u4e86\u7c7b\u4f3c\u7684\u505a\u6cd5\u3002"),(0,i.kt)("p",null,"\u4ee3\u7801\u6e05\u53555.6\u3000netlink\u7684\u4f7f\u7528\u8303\u4f8b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},' 1 #include <linux/netlink.h>\n 2\n 3 static void die(char *s)\n 4 {\n 5  write(2, s, strlen(s));\n 6  exit(1);\n 7 }\n 8\n 9 int main(int argc, char *argv[])\n10{\n11  struct sockaddr_nl nls;\n12  struct pollfd pfd;\n13  char buf[512];\n14\n15  // Open hotplug event netlink socket\n16\n17  memset(&nls, 0, sizeof(struct sockaddr_nl));\n18  nls.nl_family = AF_NETLINK;\n19  nls.nl_pid = getpid();\n20  nls.nl_groups = -1;\n21\n22  pfd.events = POLLIN;\n23  pfd.fd = socket(PF_NETLINK, SOCK_DGRAM, NETLINK_KOBJECT_UEVENT);\n24  if (pfd.fd == -1)\n25      die("Not root\\n");\n26\n27  // Listen to netlink socket\n28  if (bind(pfd.fd, (void *)&nls, sizeof(struct sockaddr_nl)))\n29      die("Bind failed\\n");\n30  while (-1 != poll(&pfd, 1, -1)) {\n31      int i, len = recv(pfd.fd, buf, sizeof(buf), MSG_DONTWAIT);\n32      if (len == -1)\n33          die("recv\\n");\n34\n35      // Print the data to stdout.\n36      i = 0;\n37      while (i < len) {\n38          printf("%s\\n", buf + i);\n39          i += strlen(buf + i) + 1;\n40      }\n41  }\n42  die("poll\\n");\n43\n44  // Dear gcc: shut up.\n45  return 0;\n46}\n')),(0,i.kt)("p",null,"\u7f16\u8bd1\u4e0a\u8ff0\u7a0b\u5e8f\u5e76\u8fd0\u884c\uff0c\u628aApple Facetime HD Camera USB\u6444\u50cf\u5934\u63d2\u5165Ubuntu\uff0c\u8be5\u7a0b\u5e8f\u4f1adump\u7c7b\u4f3c\u5982\u4e0b\u7684\u4fe1\u606f\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"ACTION=add\nDEVLINKS=/dev/input/by-id/usb-Apple_Inc._FaceTime_HD_Camera__Built-in__\nCC2B2F0TLSDG6LL0-event-if00 /dev/input/by-path/pci-0000:00:0b.0-usb-0:1:1.0-event\nDEVNAME=/dev/input/event6\nDEVPATH=/devices/pci0000:00/0000:00:0b.0/usb1/1-1/1-1:1.0/input/input6/event6\nID_BUS=usb\nID_INPUT=1\nID_INPUT_KEY=1\nID_MODEL=FaceTime_HD_Camera__Built-in_\nID_MODEL_ENC=FaceTime\\x20HD\\x20Camera\\x20\\x28Built-in\\x29\nID_MODEL_ID=8509\nID_PATH=pci-0000:00:0b.0-usb-0:1:1.0\nID_PATH_TAG=pci-\n")),(0,i.kt)("p",null,"udev\u5c31\u662f\u91c7\u7528\u8fd9\u79cd\u65b9\u5f0f\u63a5\u6536netlink\u6d88\u606f\uff0c\u5e76\u6839\u636e\u5b83\u7684\u5185\u5bb9\u548c\u7528\u6237\u8bbe\u7f6e\u7ed9udev\u7684\u89c4\u5219\u505a\u5339\u914d\u6765\u8fdb\u884c\u5de5\u4f5c\u7684\u3002\u8fd9\u91cc\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u5c31\u662f\u51b7\u63d2\u62d4\u7684\u8bbe\u5907\u600e\u4e48\u529e\uff1f\u51b7\u63d2\u62d4\u7684\u8bbe\u5907\u5728\u5f00\u673a\u65f6\u5c31\u5b58\u5728\uff0c\u5728udev\u542f\u52a8\u524d\u5df2\u7ecf\u88ab\u63d2\u5165\u4e86\u3002\u5bf9\u4e8e\u51b7\u63d2\u62d4\u7684\u8bbe\u5907\uff0cLinux\u5185\u6838\u63d0\u4f9b\u4e86sysfs\u4e0b\u9762\u4e00\u4e2auevent\u8282\u70b9\uff0c\u53ef\u4ee5\u5f80\u8be5\u8282\u70b9\u5199\u4e00\u4e2a\u201cadd\u201d\uff0c\u5bfc\u81f4\u5185\u6838\u91cd\u65b0\u53d1\u9001netlink\uff0c\u4e4b\u540eudev\u5c31\u53ef\u4ee5\u6536\u5230\u51b7\u63d2\u62d4\u7684netlink\u6d88\u606f\u4e86\u3002\u6211\u4eec\u8fd8\u662f\u8fd0\u884c\u4ee3\u7801\u6e05\u53555.6\u7684\u7a0b\u5e8f\uff0c\u5e76\u624b\u52a8\u5f80/sys/module/psmouse/uevent\u5199\u4e00\u4e2a\u201cadd\u201d\uff0c\u4e0a\u8ff0\u7a0b\u5e8f\u4f1adump\u51fa\u6765\u8fd9\u6837\u7684\u4fe1\u606f"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"ACTION=add\nDEVPATH=/module/psmouse\nSEQNUM=1682\nSUBSYSTEM=module\nUDEV_LOG=3\nUSEC_INITIALIZED=220903546792\n")),(0,i.kt)("h1",{id:"542sysfs\u6587\u4ef6\u7cfb\u7edf\u4e0elinux\u8bbe\u5907\u6a21\u578b"},"5.4.2\u3000sysfs\u6587\u4ef6\u7cfb\u7edf\u4e0eLinux\u8bbe\u5907\u6a21\u578b"),(0,i.kt)("p",null,"Linux 2.6\u4ee5\u540e\u7684\u5185\u6838\u5f15\u5165\u4e86sysfs\u6587\u4ef6\u7cfb\u7edf\uff0csysfs\u88ab\u770b\u6210\u662f\u4e0eproc\u3001devfs\u548cdevpty\u540c\u7c7b\u522b\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u8be5\u6587\u4ef6\u7cfb\u7edf\u662f\u4e00\u4e2a\u865a\u62df\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u5b83\u53ef\u4ee5\u4ea7\u751f\u4e00\u4e2a\u5305\u62ec\u6240\u6709\u7cfb\u7edf\u786c\u4ef6\u7684\u5c42\u7ea7\u89c6\u56fe\uff0c\u4e0e\u63d0\u4f9b\u8fdb\u7a0b\u548c\u72b6\u6001\u4fe1\u606f\u7684proc\u6587\u4ef6\u7cfb\u7edf\u5341\u5206\u7c7b\u4f3c\u3002"),(0,i.kt)("p",null,"sysfs\u628a\u8fde\u63a5\u5728\u7cfb\u7edf\u4e0a\u7684\u8bbe\u5907\u548c\u603b\u7ebf\u7ec4\u7ec7\u6210\u4e3a\u4e00\u4e2a\u5206\u7ea7\u7684\u6587\u4ef6\uff0c\u5b83\u4eec\u53ef\u4ee5\u7531\u7528\u6237\u7a7a\u95f4\u5b58\u53d6\uff0c\u5411\u7528\u6237\u7a7a\u95f4\u5bfc\u51fa\u5185\u6838\u6570\u636e\u7ed3\u6784\u4ee5\u53ca\u5b83\u4eec\u7684\u5c5e\u6027\u3002sysfs\u7684\u4e00\u4e2a\u76ee\u7684\u5c31\u662f\u5c55\u793a\u8bbe\u5907\u9a71\u52a8\u6a21\u578b\u4e2d\u5404\u7ec4\u4ef6\u7684\u5c42\u6b21\u5173\u7cfb\uff0c\u5176\u9876\u7ea7\u76ee\u5f55\u5305\u62ecblock\u3001bus\u3001dev\u3001devices\u3001class\u3001fs\u3001kernel\u3001power\u548cfirmware\u7b49\u3002"),(0,i.kt)("p",null,"block\u76ee\u5f55\u5305\u542b\u6240\u6709\u7684\u5757\u8bbe\u5907\uff1bdevices\u76ee\u5f55\u5305\u542b\u7cfb\u7edf\u6240\u6709\u7684\u8bbe\u5907\uff0c\u5e76\u6839\u636e\u8bbe\u5907\u6302\u63a5\u7684\u603b\u7ebf\u7c7b\u578b\u7ec4\u7ec7\u6210\u5c42\u6b21\u7ed3\u6784\uff1bbus\u76ee\u5f55\u5305\u542b\u7cfb\u7edf\u4e2d\u6240\u6709\u7684\u603b\u7ebf\u7c7b\u578b\uff1bclass\u76ee\u5f55\u5305\u542b\u7cfb\u7edf\u4e2d\u7684\u8bbe\u5907\u7c7b\u578b\uff08\u5982\u7f51\u5361\u8bbe\u5907\u3001\u58f0\u5361\u8bbe\u5907\u3001\u8f93\u5165\u8bbe\u5907\u7b49\uff09\u3002\u5728/sys\u76ee\u5f55\u4e0b\u8fd0\u884ctree\u4f1a\u5f97\u5230\u4e00\u4e2a\u76f8\u5f53\u957f\u7684\u6811\u5f62\u76ee\u5f55\uff0c\u4e0b\u9762\u6458\u53d6\u4e00\u90e8\u5206\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"tree\n.\n\u251c\u2500\u2500 block\n\u2502\xa0\xa0 \u251c\u2500\u2500 dm-0 -> ../devices/virtual/block/dm-0\n\u2502\xa0\xa0 \u251c\u2500\u2500 loop0 -> ../devices/virtual/block/loop0\n\u2502\xa0\xa0 \u251c\u2500\u2500 loop1 -> ../devices/virtual/block/loop1\n\u2502\xa0\xa0 \u251c\u2500\u2500 loop2 -> ../devices/virtual/block/loop2\n\u2502\xa0\xa0 \u251c\u2500\u2500 loop3 -> ../devices/virtual/block/loop3\n\u2502\xa0\xa0 \u251c\u2500\u2500 loop4 -> ../devices/virtual/block/loop4\n\u2502\xa0\xa0 \u251c\u2500\u2500 loop5 -> ../devices/virtual/block/loop5\n\u2502\xa0\xa0 \u251c\u2500\u2500 loop6 -> ../devices/virtual/block/loop6\n\u2502\xa0\xa0 \u251c\u2500\u2500 loop7 -> ../devices/virtual/block/loop7\n\u2502\xa0\xa0 \u251c\u2500\u2500 ram0 -> ../devices/virtual/block/ram0\n\u2502\xa0\xa0 \u251c\u2500\u2500 ram1 -> ../devices/virtual/block/ram1\n\u2502\xa0\xa0 \u251c\u2500\u2500 ram10 -> ../devices/virtual/block/ram10\n\u2502\xa0\xa0 \u251c\u2500\u2500 ram11 -> ../devices/virtual/block/ram11\n\u2502\xa0\xa0 \u251c\u2500\u2500 ram12 -> ../devices/virtual/block/ram12\n\u2502\xa0\xa0 \u251c\u2500\u2500 ram13 -> ../devices/virtual/block/ram13\n\u2502\xa0\xa0 \u251c\u2500\u2500 ram14 -> ../devices/virtual/block/ram14\n\u2502\xa0\xa0 \u251c\u2500\u2500 ram15 -> ../devices/virtual/block/ram15\n\u2502\xa0\xa0 \u251c\u2500\u2500 ram2 -> ../devices/virtual/block/ram2\n\u2502\xa0\xa0 \u251c\u2500\u2500 ram3 -> ../devices/virtual/block/ram3\n\u2502\xa0\xa0 \u251c\u2500\u2500 ram4 -> ../devices/virtual/block/ram4\n\u2502\xa0\xa0 \u251c\u2500\u2500 ram5 -> ../devices/virtual/block/ram5\n\u2502\xa0\xa0 \u251c\u2500\u2500 ram6 -> ../devices/virtual/block/ram6\n\u2502\xa0\xa0 \u251c\u2500\u2500 ram7 -> ../devices/virtual/block/ram7\n\u2502\xa0\xa0 \u251c\u2500\u2500 ram8 -> ../devices/virtual/block/ram8\n\u2502\xa0\xa0 \u251c\u2500\u2500 ram9 -> ../devices/virtual/block/ram9\n\u2502\xa0\xa0 \u251c\u2500\u2500 sda -> ../devices/pci0000:00/0000:00:0d.0/ata3/host2/target2:0:0/2:0:0:0/block/sda\n\u2502\xa0\xa0 \u2514\u2500\u2500 sr0 -> ../devices/pci0000:00/0000:00:01.1/ata2/host1/target1:0:0/1:0:0:0/block/sr0\n\u251c\u2500\u2500 bus\n\u2502\xa0\xa0 \u251c\u2500\u2500 ac97\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 devices\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 0-0:AD1980 -> ../../../devices/pci0000:00/0000:00:05.0/0-0:AD1980\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 drivers\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 drivers_autoprobe\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 drivers_probe\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 uevent\n\u2502\xa0\xa0 \u251c\u2500\u2500 acpi\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 devices\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 ACPI0003:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/ACPI0003:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 APP0001:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/device:00/APP0001:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 device:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/device:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 device:01 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/LNXVIDEO:00/device:01\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 device:02 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/device:02\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 LNXPWRBN:00 -> ../../../devices/LNXSYSTM:00/LNXPWRBN:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 LNXSLPBN:00 -> ../../../devices/LNXSYSTM:00/LNXSLPBN:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 LNXSYBUS:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 LNXSYBUS:01 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:01\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 LNXSYSTM:00 -> ../../../devices/LNXSYSTM:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 LNXVIDEO:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/LNXVIDEO:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0000:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/device:00/PNP0000:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0100:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/device:00/PNP0100:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0103:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/device:00/PNP0103:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0200:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/device:00/PNP0200:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0303:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/device:00/PNP0303:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0400:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/PNP0400:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0400:01 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/PNP0400:01\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0501:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/PNP0501:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0501:01 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/PNP0501:01\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0501:02 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/PNP0501:02\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0501:03 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/PNP0501:03\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0700:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/device:00/PNP0700:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0A03:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0B00:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/device:00/PNP0B00:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0C02:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/PNP0C02:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0C0A:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/PNP0C0A:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0C0F:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0C0F:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0C0F:01 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0C0F:01\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0C0F:02 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0C0F:02\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0C0F:03 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0C0F:03\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0F03:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/device:00/PNP0F03:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 PNP8390:00 -> ../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/PNP8390:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 drivers\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 ac\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 ACPI0003:00 -> ../../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/ACPI0003:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 bind\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 uevent\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 unbind\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 battery\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 bind\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 PNP0C0A:00 -> ../../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/PNP0C0A:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 uevent\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 unbind\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 button\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 bind\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 LNXPWRBN:00 -> ../../../../devices/LNXSYSTM:00/LNXPWRBN:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 LNXSLPBN:00 -> ../../../../devices/LNXSYSTM:00/LNXSLPBN:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 uevent\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 unbind\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 ec\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 bind\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 uevent\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 unbind\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 hardware_error_device\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 bind\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 uevent\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 unbind\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 hpet\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 bind\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 uevent\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 unbind\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 thermal\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 bind\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 uevent\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 unbind\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 video\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0     \u251c\u2500\u2500 bind\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0     \u251c\u2500\u2500 LNXVIDEO:00 -> ../../../../devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A03:00/LNXVIDEO:00\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0     \u251c\u2500\u2500 uevent\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0     \u2514\u2500\u2500 unbind\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 drivers_autoprobe\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 drivers_probe\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 uevent\n\u2502\xa0\xa0 \u251c\u2500\u2500 clockevents\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 devices\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 broadcast -> ../../../devices/system/clockevents/broadcast\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 clockevent0 -> ../../../devices/system/clockevents/clockevent0\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 drivers\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 drivers_autoprobe\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 drivers_probe\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 uevent\n\u2502\xa0\xa0 \u251c\u2500\u2500 clocksource\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 devices\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 clocksource0 -> ../../../devices/system/clocksource/clocksource0\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 drivers\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 drivers_autoprobe\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 drivers_probe\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 uevent\n\n\n\n")),(0,i.kt)("p",null,"\u5728/sys/bus\u7684pci\u7b49\u5b50\u76ee\u5f55\u4e0b\uff0c\u53c8\u4f1a\u518d\u5206\u51fadrivers\u548cdevices\u76ee\u5f55\uff0c\u800cdevices\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u662f\u5bf9/sys/devices\u76ee\u5f55\u4e2d\u6587\u4ef6\u7684\u7b26\u53f7\u94fe\u63a5\u3002\u540c\u6837\u5730\uff0c/sys/class\u76ee\u5f55\u4e0b\u4e5f\u5305\u542b\u8bb8\u591a\u5bf9/sys/devices\u4e0b\u6587\u4ef6\u7684\u94fe\u63a5\u3002\u5982\u56fe5.3\u6240\u793a\uff0cLinux\u8bbe\u5907\u6a21\u578b\u4e0e\u8bbe\u5907\u3001\u9a71\u52a8\u3001\u603b\u7ebf\u548c\u7c7b\u7684\u73b0\u5b9e\u72b6\u51b5\u662f\u76f4\u63a5\u5bf9\u5e94\u7684\uff0c\u4e5f\u6b63\u7b26\u5408Linux 2.6\u4ee5\u540e\u5185\u6838\u7684\u8bbe\u5907\u6a21\u578b\u3002"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1742828073298",src:t(92138).Z,width:"1290",height:"520"})),(0,i.kt)("p",null,"\u56fe5.3\u3000Linux\u8bbe\u5907\u6a21\u578b"),(0,i.kt)("p",null,"\u968f\u7740\u6280\u672f\u7684\u4e0d\u65ad\u8fdb\u6b65\uff0c\u7cfb\u7edf\u7684\u62d3\u6251\u7ed3\u6784\u8d8a\u6765\u8d8a\u590d\u6742\uff0c\u5bf9\u667a\u80fd\u7535\u6e90\u7ba1\u7406\u3001\u70ed\u63d2\u62d4\u4ee5\u53ca\u5373\u63d2\u5373\u7528\u7684\u652f\u6301\u8981\u6c42\u4e5f\u8d8a\u6765\u8d8a\u9ad8\uff0cLinux 2.4\u5185\u6838\u5df2\u7ecf\u96be\u4ee5\u6ee1\u8db3\u8fd9\u4e9b\u9700\u6c42\u3002\u4e3a\u9002\u5e94\u8fd9\u79cd\u5f62\u52bf\u7684\u9700\u8981\uff0cLinux 2.6\u4ee5\u540e\u7684\u5185\u6838\u5f00\u53d1\u4e86\u4e0a\u8ff0\u5168\u65b0\u7684\u8bbe\u5907\u3001\u603b\u7ebf\u3001\u7c7b\u548c\u9a71\u52a8\u73af\u73af\u76f8\u6263\u7684\u8bbe\u5907\u6a21\u578b\u3002\u56fe5.4\u5f62\u8c61\u5730\u8868\u793a\u4e86Linux\u9a71\u52a8\u6a21\u578b\u4e2d\u8bbe\u5907\u3001\u603b\u7ebf\u548c\u7c7b\u4e4b\u95f4\u7684\u5173\u7cfb\u3002"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1742828098508",src:t(4756).Z,width:"1117",height:"978"})),(0,i.kt)("p",null,"\u56fe5.4\u3000Linux\u9a71\u52a8\u6a21\u578b\u4e2d\u8bbe\u5907\u3001\u603b\u7ebf\u548c\u7c7b\u7684\u5173\u7cfb"),(0,i.kt)("p",null,"\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0cLinux 2.6\u4ee5\u540e\u7684\u5185\u6838\u4e2d\u7684\u8bbe\u5907\u9a71\u52a8\u6838\u5fc3\u5c42\u4ee3\u7801\u4f5c\u4e3a\u201c\u5e55\u540e\u5927\u4f6c\u201d\u53ef\u5904\u7406\u597d\u8fd9\u4e9b\u5173\u7cfb\uff0c\u5185\u6838\u4e2d\u7684\u603b\u7ebf\u548c\u5176\u4ed6\u5185\u6838\u5b50\u7cfb\u7edf\u4f1a\u5b8c\u6210\u4e0e\u8bbe\u5907\u6a21\u578b\u7684\u4ea4\u4e92\uff0c\u8fd9\u4f7f\u5f97\u9a71\u52a8\u5de5\u7a0b\u5e08\u5728\u7f16\u5199\u5e95\u5c42\u9a71\u52a8\u7684\u65f6\u5019\u51e0\u4e4e\u4e0d\u9700\u8981\u5173\u5fc3\u8bbe\u5907\u6a21\u578b\uff0c\u53ea\u9700\u8981\u6309\u7167\u6bcf\u4e2a\u6846\u67b6\u7684\u8981\u6c42\uff0c\u201c\u586b\u9e2d\u5f0f\u201d\u5730\u586b\u5145xxx_driver\u91cc\u9762\u7684\u5404\u79cd\u56de\u8c03\u51fd\u6570\uff0cxxx\u662f\u603b\u7ebf\u7684\u540d\u5b57\u3002\n\u5728Linux\u5185\u6838\u4e2d\uff0c\u5206\u522b\u4f7f\u7528bus_type\u3001device_driver\u548cdevice\u6765\u63cf\u8ff0\u603b\u7ebf\u3001\u9a71\u52a8\u548c\u8bbe\u5907\uff0c\u8fd93\u4e2a\u7ed3\u6784\u4f53\u5b9a\u4e49\u4e8einclude/linux/device.h\u5934\u6587\u4ef6\u4e2d\uff0c\u5176\u5b9a\u4e49\u5982\u4ee3\u7801\u6e05\u53555.7\u6240\u793a\u3002\n\u4ee3\u7801\u6e05\u53555.7\u3000bus_type\u3001device_driver\u548cdevice\u7ed3\u6784\u4f53"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"  1 struct bus_type {\n  2         const char              *name;\n  3         const char              *dev_name;\n  4         struct device           *dev_root;\n  5         struct device_attribute *dev_attrs;     /* use dev_groups instead */\n  6         const struct attribute_group **bus_groups;\n  7         const struct attribute_group **dev_groups;\n  8         const struct attribute_group **drv_groups;\n  9\n 10         int (*match)(struct device *dev, struct device_driver *drv);\n 11         int (*uevent)(struct device *dev, struct kobj_uevent_env *env);\n 12         int (*probe)(struct device *dev);\n 13         int (*remove)(struct device *dev);\n 14         void (*shutdown)(struct device *dev);\n 15\n 16         int (*online)(struct device *dev);\n 17         int (*offline)(struct device *dev);\n 18\n 19         int (*suspend)(struct device *dev, pm_message_t state);\n 20         int (*resume)(struct device *dev);\n 21\n 22         const struct dev_pm_ops *pm;\n 23\n 24         struct iommu_ops *iommu_ops;\n 25\n 26         struct subsys_private *p;\n 27         struct lock_class_key lock_key;\n 28 };\n 29\n 30 struct device_driver {\n 31         const char              *name;\n 32         struct bus_type         *bus;\n 33\n 34         struct module           *owner;\n 35         const char             *mod_name;      /* used for built-in modules */\n 36\n 37         bool suppress_bind_attrs;       /* disables bind/unbind via sysfs */\n 38\n 39         const struct of_device_id       *of_match_table;\n 40         const struct acpi_device_id     *acpi_match_table;\n 41\n 42         int (*probe) (struct device *dev);\n 43         int (*remove) (struct device *dev);\n 44         void (*shutdown) (struct device *dev);\n 45         int (*suspend) (struct device *dev, pm_message_t state);\n 46         int (*resume) (struct device *dev);\n 47         const struct attribute_group **groups;\n 48\n 49         const struct dev_pm_ops *pm;\n 50\n 51         struct driver_private *p;\n 52 };\n 53\n 54 struct device {\n 55 struct device        *parent;\n 56\n 57 struct device_private        *p;\n 58\n 59 struct kobject kobj;\n 60 const char           *init_name; /* initial name of the device */\n 61 const struct device_type *type;\n 62\n 63 struct mutex         mutex;/* mutex to synchronize calls to\n 64                       * its driver.\n 65                       */\n 66\n 67 struct bus_type      *bus;       /* type of bus device is on */\n 68 struct device_driver  *driver;   /* which driver has allocated this\n 69    device */\n 70 void         *platform_data;     /* Platform specific data, device\n 71                                     core doesn't touch it */\n 72 struct dev_pm_infopower;\n 73 struct dev_pm_domain*pm_domain;\n 74\n 75 #ifdef CONfiG_PINCTRL\n 76 struct dev_pin_info*pins;\n 77 #endif\n 78\n 79 #ifdef CONfiG_NUMA\n 80 int          numa_node;   /* NUMA node this device is close to */\n 81 #endif\n 82 u64          *dma_mask;   /* dma mask (if dma'able device) */\n 83 u64          coherent_dma_mask;/* Like dma_mask, but for\n 84                          alloc_coherent mappings as\n 85                          not all hardware supports\n 86                          64 bit addresses for consistent\n 87                          allocations such descriptors. */\n 88\n 89 struct device_dma_parameters *dma_parms;\n 90\n 91 struct list_head dma_pools; /* dma pools (if dma'ble) */\n 92\n 93 struct dma_coherent_mem     *dma_mem; /* internal for coherent mem\n 94                                         override */\n 95 #ifdef CONfiG_DMA_CMA\n 96 struct cma *cma_area;       /* contiguous memory area for dma\n 97                                allocations */\n 98 #endif\n 99 /* arch specific additions */\n100 struct dev_archdataarchdata;\n101\n102 struct device_node   *of_node;     /* associated device tree node */\n103 struct acpi_dev_node acpi_node;    /* associated ACPI device node */\n104\n105 dev_t                devt;         /* dev_t, creates the sysfs \"dev\" */\n106 u32                  id;           /* device instance */\n107\n108 spinlock_t           devres_lock;\n109 struct list_head     devres_head;\n110\n111 struct klist_node    knode_class;\n112 struct class         *class;\n113 const struct attribute_group **groups;     /* optional groups */\n114\n115 void(*release)(struct device *dev);\n116 struct iommu_group   *iommu_group;\n117\n118 boo          offline_disabled:1;\n119 boo          offline:1;\n120 };\n")),(0,i.kt)("p",null,"device_driver\u548cdevice\u5206\u522b\u8868\u793a\u9a71\u52a8\u548c\u8bbe\u5907\uff0c\u800c\u8fd9\u4e24\u8005\u90fd\u5fc5\u987b\u4f9d\u9644\u4e8e\u4e00\u79cd\u603b\u7ebf\uff0c\u56e0\u6b64\u90fd\u5305\u542bstruct bus_type\u6307\u9488\u3002\u5728Linux\u5185\u6838\u4e2d\uff0c\u8bbe\u5907\u548c\u9a71\u52a8\u662f\u5206\u5f00\u6ce8\u518c\u7684\uff0c\u6ce8\u518c1\u4e2a\u8bbe\u5907\u7684\u65f6\u5019\uff0c\u5e76\u4e0d\u9700\u8981\u9a71\u52a8\u5df2\u7ecf\u5b58\u5728\uff0c\u800c1\u4e2a\u9a71\u52a8\u88ab\u6ce8\u518c\u7684\u65f6\u5019\uff0c\u4e5f\u4e0d\u9700\u8981\u5bf9\u5e94\u7684\u8bbe\u5907\u5df2\u7ecf\u88ab\u6ce8\u518c\u3002\u8bbe\u5907\u548c\u9a71\u52a8\u5404\u81ea\u6d8c\u5411\u5185\u6838\uff0c\u800c\u6bcf\u4e2a\u8bbe\u5907\u548c\u9a71\u52a8\u6d8c\u5165\u5185\u6838\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u53bb\u5bfb\u627e\u81ea\u5df1\u7684\u53e6\u4e00\u534a\uff0c\u800c\u6b63\u662fbus_type\u7684match\uff08\uff09\u6210\u5458\u51fd\u6570\u5c06\u4e24\u8005\u6346\u7ed1\u5728\u4e00\u8d77\u3002\u7b80\u5355\u5730\u8bf4\uff0c\u8bbe\u5907\u548c\u9a71\u52a8\u5c31\u662f\u7ea2\u5c18\u4e2d\u6f02\u6d6e\u7684\u7537\u5973\uff0c\u800cbus_type\u7684match\uff08\uff09\u5219\u662f\u7275\u5f15\u7ea2\u7ebf\u7684\u6708\u8001\uff0c\u5b83\u53ef\u4ee5\u8bc6\u522b\u4ec0\u4e48\u8bbe\u5907\u4e0e\u4ec0\u4e48\u9a71\u52a8\u662f\u53ef\u914d\u5bf9\u7684\u3002\u4e00\u65e6\u914d\u5bf9\u6210\u529f\uff0cxxx_driver\u7684probe\uff08\uff09\u5c31\u88ab\u6267\u884c\uff08xxx\u662f\u603b\u7ebf\u540d\uff0c\u5982platform\u3001pci\u3001i2c\u3001spi\u3001usb\u7b49\uff09\u3002"),(0,i.kt)("p",null,"\u6ce8\u610f\uff1a \u603b\u7ebf\u3001\u9a71\u52a8\u548c\u8bbe\u5907\u6700\u7ec8\u90fd\u4f1a\u843d\u5b9e\u4e3asysfs\u4e2d\u76841\u4e2a\u76ee\u5f55\uff0c\u56e0\u4e3a\u8fdb\u4e00\u6b65\u8ffd\u8e2a\u4ee3\u7801\u4f1a\u53d1\u73b0\uff0c\u5b83\u4eec\u5b9e\u9645\u4e0a\u90fd\u53ef\u4ee5\u8ba4\u4e3a\u662fkobject\u7684\u6d3e\u751f\u7c7b\uff0ckobject\u53ef\u770b\u4f5c\u662f\u6240\u6709\u603b\u7ebf\u3001\u8bbe\u5907\u548c\u9a71\u52a8\u7684\u62bd\u8c61\u57fa\u7c7b\uff0c1\u4e2akobject\u5bf9\u5e94sysfs\u4e2d\u76841\u4e2a\u76ee\u5f55\u3002"),(0,i.kt)("p",null,"\u603b\u7ebf\u3001\u8bbe\u5907\u548c\u9a71\u52a8\u4e2d\u7684\u5404\u4e2aattribute\u5219\u76f4\u63a5\u843d\u5b9e\u4e3asysfs\u4e2d\u76841\u4e2a\u6587\u4ef6\uff0cattribute\u4f1a\u4f34\u968f\u7740show\uff08\uff09\u548cstore\uff08\uff09\u8fd9\u4e24\u4e2a\u51fd\u6570\uff0c\u5206\u522b\u7528\u4e8e\u8bfb\u5199\u8be5attribute\u5bf9\u5e94\u7684sysfs\u6587\u4ef6\uff0c\u4ee3\u7801\u6e05\u53555.8\u7ed9\u51fa\u4e86attribute\u3001bus_attribute\u3001driver_attribute\u548cdevice_attribute\u8fd9\u51e0\u4e2a\u7ed3\u6784\u4f53\u7684\u5b9a\u4e49\u3002\n\u4ee3\u7801\u6e05\u53555.8\u3000attribute\u3001bus_attribute\u3001driver_attribute\u548cdevice_attribute\u7ed3\u6784\u4f53"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"}," 1 struct attribute {\n 2         const char              *name;\n 3         umode_t                 mode;\n 4 #ifdef CONfiG_DEBUG_LOCK_ALLOC\n 5         bool                    ignore_lockdep:1;\n 6         struct lock_class_key   *key;\n 7         struct lock_class_key   skey;\n 8 #endif\n 9 };\n10\n11 struct bus_attribute {\n12        struct attribute        attr;\n13        ssize_t (*show)(struct bus_type *bus, char *buf);\n14        ssize_t (*store)(struct bus_type *bus, const char *buf, size_t count);\n15 };\n16\n17 struct driver_attribute {\n18        struct attribute attr;\n19        ssize_t (*show)(struct device_driver *driver, char *buf);\n20        ssize_t (*store)(struct device_driver *driver, const char *buf,\n21                          size_t count);\n22 };\n23\n24 struct device_attribute {\n25        struct attribute        attr;\n26        ssize_t (*show)(struct device *dev, struct device_attribute *attr,\n27                        char *buf);\n28        ssize_t (*store)(struct device *dev, struct device_attribute *attr,\n29                         const char *buf, size_t count);\n30 };\n")),(0,i.kt)("p",null,"\u4e8b\u5b9e\u4e0a\uff0csysfs\u4e2d\u7684\u76ee\u5f55\u6765\u6e90\u4e8ebus_type\u3001device_driver\u3001device\uff0c\u800c\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u5219\u6765\u6e90\u4e8eattribute\u3002Linux\u5185\u6838\u4e2d\u4e5f\u5b9a\u4e49\u4e86\u4e00\u4e9b\u5feb\u6377\u65b9\u5f0f\u4ee5\u65b9\u4fbfattribute\u7684\u521b\u5efa\u5de5\u4f5c\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"#define DRIVER_ATTR(_name, _mode, _show, _store) \\\nstruct driver_attribute driver_attr_##_name = __ATTR(_name, _mode, _show, _store)\n#define DRIVER_ATTR_RW(_name) \\\n        struct driver_attribute driver_attr_##_name = __ATTR_RW(_name)\n#define DRIVER_ATTR_RO(_name) \\\n        struct driver_attribute driver_attr_##_name = __ATTR_RO(_name)\n#define DRIVER_ATTR_WO(_name) \\\n        struct driver_attribute driver_attr_##_name = __ATTR_WO(_name)\n#define DRIVER_ATTR(_name, _mode, _show, _store) \\\n        struct driver_attribute driver_attr_##_name = __ATTR(_name, _mode, _show, _store)\n#define DRIVER_ATTR_RW(_name) \\\n        struct driver_attribute driver_attr_##_name = __ATTR_RW(_name)\n#define DRIVER_ATTR_RO(_name) \\\n        struct driver_attribute driver_attr_##_name = __ATTR_RO(_name)\n#define DRIVER_ATTR_WO(_name) \\\n        struct driver_attribute driver_attr_##_name = __ATTR_WO(_name)\n#define BUS_ATTR(_name, _mode, _show, _store)   \\\n        struct bus_attribute bus_attr_##_name = __ATTR(_name, _mode, _show, _store)\n#define BUS_ATTR_RW(_name) \\\n        struct bus_attribute bus_attr_##_name = __ATTR_RW(_name)\n#define BUS_ATTR_RO(_name) \\\n        struct bus_attribute bus_attr_##_name = __ATTR_RO(_name)\n")),(0,i.kt)("p",null,"\u6bd4\u5982\uff0c\u6211\u4eec\u5728drivers/base/bus.c\u6587\u4ef6\u4e2d\u53ef\u4ee5\u627e\u5230\u8fd9\u6837\u7684\u4ee3\u7801\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"static BUS_ATTR(drivers_probe, S_IWUSR, NULL, store_drivers_probe);\nstatic BUS_ATTR(drivers_autoprobe, S_IWUSR | S_IRUGO,\n             show_drivers_autoprobe, store_drivers_autoprobe);\nstatic BUS_ATTR(uevent, S_IWUSR, NULL, bus_uevent_store);\n")),(0,i.kt)("p",null,"\u800c\u5728/sys/bus/platform\u7b49\u91cc\u9762\u5c31\u53ef\u4ee5\u627e\u5230\u5bf9\u5e94\u7684\u6587\u4ef6\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"barry@barry-VirtualBox:/sys/bus/platform$ ls\ndevices  drivers  drivers_autoprobe  drivers_probe  uevent\n")),(0,i.kt)("p",null,"\u4ee3\u7801\u6e05\u53555.9\u7684\u811a\u672c\u53ef\u4ee5\u904d\u5386\u6574\u4e2asysfs\uff0c\u5e76\u4e14dump\u51fa\u6765\u603b\u7ebf\u3001\u8bbe\u5907\u548c\u9a71\u52a8\u4fe1\u606f\u3002\n\u4ee3\u7801\u6e05\u53555.9\u3000\u904d\u5386sysfs"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"}," 1 #!/bin/bash\n 2\n 3   # Populate block devices\n 4\n 5   for i in /sys/block/*/dev /sys/block/*/*/dev\n 6   do\n 7     if [ -f $i ]\n 8     then\n 9       MAJOR=$(sed 's/:.*//' < $i)\n10       MINOR=$(sed 's/.*://' < $i)\n11       DEVNAME=$(echo $i | sed -e 's@/dev@@' -e 's@.*/@@')\n12       echo /dev/$DEVNAME b $MAJOR $MINOR\n13       #mknod /dev/$DEVNAME b $MAJOR $MINOR\n14     fi\n15   done\n16\n17   # Populate char devices\n18\n19   for i in /sys/bus/*/devices/*/dev /sys/class/*/*/dev\n20   do\n21     if [ -f $i ]\n22     then\n23       MAJOR=$(sed 's/:.*//' < $i)\n24       MINOR=$(sed 's/.*://' < $i)\n25       DEVNAME=$(echo $i | sed -e 's@/dev@@' -e 's@.*/@@')\n26       echo /dev/$DEVNAME c $MAJOR $MINOR\n27       #mknod /dev/$DEVNAME c $MAJOR $MINOR\n28     fi\n29   done\n")),(0,i.kt)("p",null,"\u4e0a\u8ff0\u811a\u672c\u904d\u5386sysfs\uff0c\u627e\u51fa\u6240\u6709\u7684\u8bbe\u5907\uff0c\u5e76\u5206\u6790\u51fa\u6765\u8bbe\u5907\u540d\u548c\u4e3b\u6b21\u8bbe\u5907\u53f7\u3002\u5982\u679c\u6211\u4eec\u628a27\u884c\u524d\u7684\u201c#\u201d\u53bb\u6389\uff0c\u8be5\u811a\u672c\u5b9e\u9645\u4e0a\u8fd8\u53ef\u4ee5\u4e3a\u6574\u4e2a\u7cfb\u7edf\u4e2d\u7684\u8bbe\u5907\u5efa\u7acb/dev/\u4e0b\u9762\u7684\u8282\u70b9\u3002"),(0,i.kt)("h1",{id:"543udev\u7684\u7ec4\u6210"},"5.4.3\u3000udev\u7684\u7ec4\u6210"),(0,i.kt)("p",null,"udev\u76ee\u524d\u548csystemd\u9879\u76ee\u5408\u5e76\u5728\u4e00\u8d77\u4e86\uff0c\u89c1\u4f4d\u4e8e",(0,i.kt)("a",{parentName:"p",href:"https://lwn.net/Articles/490413/"},"https://lwn.net/Articles/490413/")," \u7684\u6587\u6863\u300aUdev and systemd to merge\u300b\uff0c\u53ef\u4ee5\u4ece",(0,i.kt)("a",{parentName:"p",href:"http://cgit.freedesktop.org/systemd/"},"http://cgit.freedesktop.org/systemd/")," \u3001",(0,i.kt)("a",{parentName:"p",href:"https://github.com/systemd/systemd"},"https://github.com/systemd/systemd")," \u7b49\u4f4d\u7f6e\u4e0b\u8f7d\u6700\u65b0\u7684\u4ee3\u7801\u3002udev\u5728\u7528\u6237\u7a7a\u95f4\u4e2d\u6267\u884c\uff0c\u52a8\u6001\u5efa\u7acb/\u5220\u9664\u8bbe\u5907\u6587\u4ef6\uff0c\u5141\u8bb8\u6bcf\u4e2a\u4eba\u90fd\u4e0d\u7528\u5173\u5fc3\u4e3b/\u6b21\u8bbe\u5907\u53f7\u800c\u63d0\u4f9bLSB\uff08Linux\u6807\u51c6\u89c4\u8303\uff0cLinux Standard Base\uff09\u540d\u79f0\uff0c\u5e76\u4e14\u53ef\u4ee5\u6839\u636e\u9700\u8981\u56fa\u5b9a\u540d\u79f0\u3002udev\u7684\u5de5\u4f5c\u8fc7\u7a0b\u5982\u4e0b\u3002"),(0,i.kt)("p",null,"1\uff09\u5f53\u5185\u6838\u68c0\u6d4b\u5230\u7cfb\u7edf\u4e2d\u51fa\u73b0\u4e86\u65b0\u8bbe\u5907\u540e\uff0c\u5185\u6838\u4f1a\u901a\u8fc7netlink\u5957\u63a5\u5b57\u53d1\u9001uevent\u3002"),(0,i.kt)("p",null,"2\uff09udev\u83b7\u53d6\u5185\u6838\u53d1\u9001\u7684\u4fe1\u606f\uff0c\u8fdb\u884c\u89c4\u5219\u7684\u5339\u914d\u3002\u5339\u914d\u7684\u4e8b\u7269\u5305\u62ecSUBSYSTEM\u3001ACTION\u3001atttribute\u3001\u5185\u6838\u63d0\u4f9b\u7684\u540d\u79f0\uff08\u901a\u8fc7KERNEL=\uff09\u4ee5\u53ca\u5176\u4ed6\u7684\u73af\u5883\u53d8\u91cf\u3002"),(0,i.kt)("p",null,"\u5047\u8bbe\u5728Linux\u7cfb\u7edf\u4e0a\u63d2\u5165\u4e00\u4e2aKingston\u7684U\u76d8\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7udev\u7684\u5de5\u5177\u201cudevadm monitor--kernel--property--udev\u201d\u6355\u83b7\u5230\u7684uevent\u5305\u542b\u7684\u4fe1\u606f\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"UDEV  [6328.797974] add\n/devices/pci0000:00/0000:00:0b.0/usb1/1-1/1-1:1.0/host7/target7:0:0/7:0:0:0/block/sdc (block)\nACTION=add\nDEVLINKS=/dev/disk/by-id/usb-Kingston_DataTraveler_2.0_5B8212000047-0:0 /dev/\n        disk/by-path/pci-0000:00:0b.0-usb-0:1:1.0-scsi-0:0:0:0\nDEVNAME=/dev/sdc\nDEVPATH=/devices/pci0000:00/0000:00:0b.0/usb1/1-1/1-1:1.0/host7/target7:0:0/7:0:0:0/\n         block/sdc\nDEVTYPE=disk\nID_BUS=usb\nID_INSTANCE=0:0\nID_MODEL=DataTraveler_2.0\nID_MODEL_ENC=DataTraveler\\x202.0\nID_MODEL_ID=6545\nID_PART_TABLE_TYPE=dos\nID_PATH=pci-0000:00:0b.0-usb-0:1:1.0-scsi-0:0:0:0\nID_PATH_TAG=pci-0000_00_0b_0-usb-0_1_1_0-scsi-0_0_0_0\nID_REVISION=PMAP\nID_SERIAL=Kingston_DataTraveler_2.0_5B8212000047-0:0\nID_SERIAL_SHORT=5B8212000047\nID_TYPE=disk\nID_USB_DRIVER=usb-storage\nID_USB_INTERFACES=:080650:\nID_USB_INTERFACE_NUM=00\nID_VENDOR=Kingston\nID_VENDOR_ENC=Kingston\nID_VENDOR_ID=0930\nMAJOR=8\nMINOR=32\nSEQNUM=2335\nSUBSYSTEM=block\n")),(0,i.kt)("p",null,"\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u8fd9\u4e9b\u4fe1\u606f\uff0c\u521b\u5efa\u4e00\u4e2a\u89c4\u5219\uff0c\u4ee5\u4fbf\u6bcf\u6b21\u63d2\u5165\u7684\u65f6\u5019\uff0c\u4e3a\u8be5\u76d8\u521b\u5efa\u4e00\u4e2a/dev/kingstonUD\u7684\u7b26\u53f7\u94fe\u63a5\uff0c\u8fd9\u4e2a\u89c4\u5219\u53ef\u4ee5\u5199\u6210\u4ee3\u7801\u6e05\u53555.10\u7684\u6837\u5b50\u3002"),(0,i.kt)("p",null,"\u4ee3\u7801\u6e05\u53555.10\u3000\u8bbe\u5907\u547d\u540d\u89c4\u5219\u8303\u4f8b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'# Kingston USB mass storage\nSUBSYSTEM=="block", ACTION=="add", KERNEL=="*sd ", ENV{ID_TYPE}=="disk",\n     ENV{ID_VENDOR}=="Kingston", ENV{ID_USB_DRIVER}=="usb-storage", SYMLINK+="kingstonUD"\n')),(0,i.kt)("p",null,"\u63d2\u5165kingston U\u76d8\u540e\uff0c/dev/\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a\u7b26\u53f7\u94fe\u63a5\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"root@barry-VirtualBox:/dev# ls -l kingstonUD\nlrwxrwxrwx 1 root root 3 Jun 30 19:31 kingstonUD -> sdc\n")),(0,i.kt)("h1",{id:"544udev\u89c4\u5219\u6587\u4ef6"},"5.4.4\u3000udev\u89c4\u5219\u6587\u4ef6"),(0,i.kt)("p",null,"udev\u7684\u89c4\u5219\u6587\u4ef6\u4ee5\u884c\u4e3a\u5355\u4f4d\uff0c\u4ee5\u201c#\u201d\u5f00\u5934\u7684\u884c\u4ee3\u8868\u6ce8\u91ca\u884c\u3002\u5176\u4f59\u7684\u6bcf\u4e00\u884c\u4ee3\u8868\u4e00\u4e2a\u89c4\u5219\u3002\u6bcf\u4e2a\u89c4\u5219\u5206\u6210\u4e00\u4e2a\u6216\u591a\u4e2a\u5339\u914d\u90e8\u5206\u548c\u8d4b\u503c\u90e8\u5206\u3002\u5339\u914d\u90e8\u5206\u7528\u5339\u914d\u4e13\u7528\u7684\u5173\u952e\u5b57\u6765\u8868\u793a\uff0c\u76f8\u5e94\u7684\u8d4b\u503c\u90e8\u5206\u7528\u8d4b\u503c\u4e13\u7528\u7684\u5173\u952e\u5b57\u6765\u8868\u793a\u3002\u5339\u914d\u5173\u952e\u5b57\u5305\u62ec\uff1aACTION\uff08\u884c\u4e3a\uff09\u3001KERNEL\uff08\u5339\u914d\u5185\u6838\u8bbe\u5907\u540d\uff09\u3001BUS\uff08\u5339\u914d\u603b\u7ebf\u7c7b\u578b\uff09\u3001SUBSYSTEM\uff08\u5339\u914d\u5b50\u7cfb\u7edf\u540d\uff09\u3001ATTR\uff08\u5c5e\u6027\uff09\u7b49\uff0c\u8d4b\u503c\u5173\u952e\u5b57\u5305\u62ec\uff1aNAME\uff08\u521b\u5efa\u7684\u8bbe\u5907\u6587\u4ef6\u540d\uff09\u3001SYMLINK\uff08\u7b26\u53f7\u521b\u5efa\u94fe\u63a5\u540d\uff09\u3001OWNER\uff08\u8bbe\u7f6e\u8bbe\u5907\u7684\u6240\u6709\u8005\uff09\u3001GROUP\uff08\u8bbe\u7f6e\u8bbe\u5907\u7684\u7ec4\uff09\u3001IMPORT\uff08\u8c03\u7528\u5916\u90e8\u7a0b\u5e8f\uff09\u3001MODE\uff08\u8282\u70b9\u8bbf\u95ee\u6743\u9650\uff09\u7b49\u3002"),(0,i.kt)("p",null,"\u4f8b\u5982\uff0c\u5982\u4e0b\u89c4\u5219\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'SUBSYSTEM=="net", ACTION=="add", DRIVERS==" *", ATTR{address}=="08:00:27:35:be:ff",\n        ATTR{dev_id}=="0x0", ATTR{type}=="1", KERNEL=="eth*", NAME="eth1"\n')),(0,i.kt)("p",null,"\u5176\u4e2d\u7684\u201c\u5339\u914d\u201d\u90e8\u5206\u5305\u62ecSUBSYSTEM\u3001ACTION\u3001ATTR\u3001KERNEL\u7b49\uff0c\u800c\u201c\u8d4b\u503c\u201d\u90e8\u5206\u6709\u4e00\u9879\uff0c\u662fNAME\u3002\u8fd9\u4e2a\u89c4\u5219\u7684\u610f\u601d\u662f\uff1a\u5f53\u7cfb\u7edf\u4e2d\u51fa\u73b0\u7684\u65b0\u786c\u4ef6\u5c5e\u4e8enet\u5b50\u7cfb\u7edf\u8303\u7574\uff0c\u7cfb\u7edf\u5bf9\u8be5\u786c\u4ef6\u91c7\u53d6\u7684\u52a8\u4f5c\u662f\u201cadd\u201d\u8fd9\u4e2a\u786c\u4ef6\uff0c\u4e14\u8fd9\u4e2a\u786c\u4ef6\u7684\u201caddress\u201d\u5c5e\u6027\u4fe1\u606f\u7b49\u4e8e\u201c08\uff1a00\uff1a27\uff1a35\uff1abe\uff1aff\u201d\uff0c\u201cdev_id\u201d\u5c5e\u6027\u7b49\u4e8e\u201c0x0\u201d\u3001\u201ctype\u201d\u5c5e\u6027\u4e3a1\u7b49\uff0c\u6b64\u65f6\uff0c\u5bf9\u8fd9\u4e2a\u786c\u4ef6\u5728udev\u5c42\u6b21\u65bd\u884c\u7684\u52a8\u4f5c\u662f\u521b\u5efa/dev/eth1\u3002"),(0,i.kt)("p",null,"\u901a\u8fc7\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u53ef\u4ee5\u770b\u51faudev\u548cdevfs\u5728\u547d\u540d\u65b9\u9762\u7684\u5dee\u5f02\u3002\u5982\u679c\u7cfb\u7edf\u4e2d\u6709\u4e24\u4e2aUSB\u6253\u5370\u673a\uff0c\u4e00\u4e2a\u53ef\u80fd\u88ab\u79f0\u4e3a/dev/usb/lp0\uff0c\u53e6\u5916\u4e00\u4e2a\u4fbf\u662f/dev/usb/lp1\u3002\u4f46\u662f\u5230\u5e95\u54ea\u4e2a\u6587\u4ef6\u5bf9\u5e94\u54ea\u4e2a\u6253\u5370\u673a\u662f\u65e0\u6cd5\u786e\u5b9a\u7684\uff0clp0\u3001lp1\u548c\u5b9e\u9645\u7684\u8bbe\u5907\u6ca1\u6709\u4e00\u4e00\u5bf9\u5e94\u7684\u5173\u7cfb\uff0c\u6620\u5c04\u5173\u7cfb\u4f1a\u56e0\u8bbe\u5907\u53d1\u73b0\u7684\u987a\u5e8f\u3001\u6253\u5370\u673a\u672c\u8eab\u5173\u95ed\u7b49\u800c\u4e0d\u786e\u5b9a\u3002\u56e0\u6b64\uff0c\u7406\u60f3\u7684\u65b9\u5f0f\u662f\u4e24\u4e2a\u6253\u5370\u673a\u5e94\u8be5\u91c7\u7528\u57fa\u4e8e\u5b83\u4eec\u7684\u5e8f\u5217\u53f7\u6216\u8005\u5176\u4ed6\u6807\u8bc6\u4fe1\u606f\u7684\u529e\u6cd5\u6765\u8fdb\u884c\u786e\u5b9a\u7684\u6620\u5c04\uff0cdevfs\u65e0\u6cd5\u505a\u5230\u8fd9\u4e00\u70b9\uff0cudev\u5374\u53ef\u4ee5\u505a\u5230\u3002\u4f7f\u7528\u5982\u4e0b\u89c4\u5219\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'SUBSYSTEM="usb",ATTR{serial}="HXOLL0012202323480",NAME="lp_epson",SYMLINK+="printers/\n         epson_stylus"\n')),(0,i.kt)("p",null,"\u8be5\u89c4\u5219\u4e2d\u7684\u5339\u914d\u9879\u76ee\u6709SUBSYSTEM\u548cATTR\uff0c\u8d4b\u503c\u9879\u76ee\u4e3aNAME\u548cSYMLINK\uff0c\u5b83\u610f\u5473\u7740\u5f53\u4e00\u53f0USB\u6253\u5370\u673a\u7684\u5e8f\u5217\u53f7\u4e3a\u201cHXOLL0012202323480\u201d\u65f6\uff0c\u521b\u5efa/dev/lp_epson\u6587\u4ef6\uff0c\u5e76\u540c\u65f6\u521b\u5efa\u4e00\u4e2a\u7b26\u53f7\u94fe\u63a5/dev/printers/epson_styles\u3002\u5e8f\u5217\u53f7\u4e3a\u201cHXOLL0012202323480\u201d\u7684USB\u6253\u5370\u673a\u4e0d\u7ba1\u4f55\u65f6\u88ab\u63d2\u5165\uff0c\u5bf9\u5e94\u7684\u8bbe\u5907\u540d\u90fd\u662f/dev/lp_epson\uff0c\u800cdevfs\u663e\u7136\u65e0\u6cd5\u5b9e\u73b0\u8bbe\u5907\u7684\u8fd9\u79cd\u56fa\u5b9a\u547d\u540d\u3002"),(0,i.kt)("p",null,"udev\u89c4\u5219\u7684\u5199\u6cd5\u975e\u5e38\u7075\u6d3b\uff0c\u5728\u5339\u914d\u90e8\u5206\uff0c\u53ef\u4ee5\u901a\u8fc7\u201c",(0,i.kt)("em",{parentName:"p"},"\u201d\u3001\u201c\uff1f\u201d\u3001","[a~c]","\u3001","[1~9]","\u7b49shell\u901a\u914d\u7b26\u6765\u7075\u6d3b\u5339\u914d\u591a\u4e2a\u9879\u76ee\u3002"),"\u7c7b\u4f3c\u4e8eshell\u4e2d\u7684*\u901a\u914d\u7b26\uff0c\u4ee3\u66ff\u4efb\u610f\u957f\u5ea6\u7684\u4efb\u610f\u5b57\u7b26\u4e32\uff0c\uff1f\u4ee3\u66ff\u4e00\u4e2a\u5b57\u7b26\u3002\u6b64\u5916\uff0c%k\u5c31\u662fKERNEL\uff0c%n\u5219\u662f\u8bbe\u5907\u7684KERNEL\u5e8f\u53f7\uff08\u5982\u5b58\u50a8\u8bbe\u5907\u7684\u5206\u533a\u53f7\uff09\u3002"),(0,i.kt)("p",null,"\u53ef\u4ee5\u501f\u52a9udev\u4e2d\u7684udevadm info\u5de5\u5177\u67e5\u627e\u89c4\u5219\u6587\u4ef6\u80fd\u5229\u7528\u7684\u5185\u6838\u4fe1\u606f\u548csysfs\u5c5e\u6027\u4fe1\u606f\uff0c\u5982\u8fd0\u884c\u201cudevadm info-a-p/sys/devices/platform/serial8250/tty/ttyS0\u201d\u547d\u4ee4\u5c06\u5f97\u5230\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'udevadm info -a -p  /sys/devices/platform/serial8250/tty/ttyS0\nUdevadm info starts with the device specified by the devpath and then\nwalks up the chain of parent devices. It prints for every device\nfound, all possible attributes in the udev rules key format.\nA rule to match, can be composed by the attributes of the device\nand the attributes from one single parent device.\n  looking at device \'/devices/platform/serial8250/tty/ttyS0\':\n    KERNEL=="ttyS0"\n    SUBSYSTEM=="tty"\n    DRIVER==""\n    ATTR{irq}=="4"\n    ATTR{line}=="0"\n    ATTR{port}=="0x3F8"\n    ATTR{type}=="0"\n    ATTR{flags}=="0x10000040"\n    ATTR{iomem_base}=="0x0"\n    ATTR{custom_divisor}=="0"\n    ATTR{iomem_reg_shift}=="0"\n    ATTR{uartclk}=="1843200"\n    ATTR{xmit_fifo_size}=="0"\n    ATTR{close_delay}=="50"\n    ATTR{closing_wait}=="3000"\n    ATTR{io_type}=="0"\n  looking at parent device \'/devices/platform/serial8250\':\n    KERNELS=="serial8250"\n    SUBSYSTEMS=="platform"\n    DRIVERS=="serial8250"\n  looking at parent device \'/devices/platform\':\n    KERNELS=="platform"\n    SUBSYSTEMS==""\n    DRIVERS==""\n')),(0,i.kt)("p",null,"\u5982\u679c/dev/\u4e0b\u9762\u7684\u8282\u70b9\u5df2\u7ecf\u88ab\u521b\u5efa\uff0c\u4f46\u662f\u4e0d\u77e5\u9053\u5b83\u5bf9\u5e94\u7684/sys\u5177\u4f53\u8282\u70b9\u8def\u5f84\uff0c\u53ef\u4ee5\u91c7\u7528\u201cudevadm info-a-p$\uff08udevadm info-q path-n/dev/<\u8282\u70b9\u540d>\uff09\u201d\u547d\u4ee4\u53cd\u5411\u5206\u6790\uff0c\u6bd4\u5982\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'udevadm info -a -p  $(udevadm info -q path -n /dev/sdb)\nUdevadm info starts with the device specified by the devpath and then\nwalks up the chain of parent devices. It prints for every device\nfound, all possible attributes in the udev rules key format.\nA rule to match, can be composed by the attributes of the device\nand the attributes from one single parent device.\n  looking at device \'/devices/pci0000:00/0000:00:0d.0/ata4/host3/target3:0:0/3:0:0:0/block/sdb\':\n    KERNEL=="sdb"\n    SUBSYSTEM=="block"\n    DRIVER==""\n    ATTR{ro}=="0"\n    ATTR{size}=="71692288"\n    ATTR{stat}=="     584     1698     4669     7564        0        0        0\n        0        0     7564     7564"\n    ATTR{range}=="16"\n    ATTR{discard_alignment}=="0"\n    ATTR{events}==""\n    ATTR{ext_range}=="256"\n    ATTR{events_poll_msecs}=="-1"\n    ATTR{alignment_offset}=="0"\n    ATTR{inflight}=="       0        0"\n    ATTR{removable}=="0"\n    ATTR{capability}=="50"\n    ATTR{events_async}==""\n  looking at parent device \'/devices/pci0000:00/0000:00:0d.0/ata4/host3/\n           target3:0:0/3:0:0:0\':\n    KERNELS=="3:0:0:0"\n    SUBSYSTEMS=="scsi"\n    DRIVERS=="sd"\n    ATTRS{rev}=="1.0 "\n    ATTRS{type}=="0"\n    ATTRS{scsi_level}=="6"\n    ATTRS{model}=="VBOX HARDDISK   "\n    ATTRS{state}=="running"\n    ATTRS{queue_type}=="simple"\n    ATTRS{iodone_cnt}=="0x299"\n    ATTRS{iorequest_cnt}=="0x29a"\n    ATTRS{queue_ramp_up_period}=="120000"\n    ATTRS{timeout}=="30"\n    ATTRS{evt_media_change}=="0"\n    ATTRS{ioerr_cnt}=="0x7"\n    ATTRS{queue_depth}=="31"\n    ATTRS{vendor}=="ATA     "\n    ATTRS{device_blocked}=="0"\n    ATTRS{iocounterbits}=="32"\n  looking at parent device \'/devices/pci0000:00/0000:00:0d.0/ata4/host3/\n           target3:0:0\':\n    KERNELS=="target3:0:0"\n    SUBSYSTEMS=="scsi"\n    DRIVERS==""\n  looking at parent device \'/devices/pci0000:00/0000:00:0d.0/ata4/host3\':\n    KERNELS=="host3"\n    SUBSYSTEMS=="scsi"\n    DRIVERS==""\n  looking at parent device \'/devices/pci0000:00/0000:00:0d.0/ata4\':\n    KERNELS=="ata4"\n    SUBSYSTEMS==""\n    DRIVERS==""\n  looking at parent device \'/devices/pci0000:00/0000:00:0d.0\':\n    KERNELS=="0000:00:0d.0"\n    SUBSYSTEMS=="pci"\n    DRIVERS=="ahci"\n    ATTRS{irq}=="21"\n    ATTRS{subsystem_vendor}=="0x0000"\n    ATTRS{broken_parity_status}=="0"\n    ATTRS{class}=="0x010601"\n    ATTRS{consistent_dma_mask_bits}=="64"\n    ATTRS{dma_mask_bits}=="64"\n    ATTRS{local_cpus}=="ff"\n    ATTRS{device}=="0x2829"\n    ATTRS{enable}=="1"\n    ATTRS{msi_bus}==""\n    ATTRS{local_cpulist}=="0-7"\n    ATTRS{vendor}=="0x8086"\n    ATTRS{subsystem_device}=="0x0000"\n    ATTRS{d3cold_allowed}=="1"\n  looking at parent device \'/devices/pci0000:00\':\n    KERNELS=="pci0000:00"\n    SUBSYSTEMS==""\n    DRIVERS==""\n')),(0,i.kt)("p",null,"\u5728\u5d4c\u5165\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u4e5f\u53ef\u4ee5\u7528udev\u7684\u8f7b\u91cf\u7ea7\u7248\u672cmdev\uff0cmdev\u96c6\u6210\u4e8ebusybox\u4e2d\u3002\u5728\u7f16\u8bd1busybox\u7684\u65f6\u5019\uff0c\u9009\u4e2dmdev\u76f8\u5173\u9879\u76ee\u5373\u53ef\u3002"),(0,i.kt)("p",null,"Android\u4e5f\u6ca1\u6709\u91c7\u7528udev\uff0c\u5b83\u91c7\u7528\u7684\u662fvold\u3002vold\u7684\u673a\u5236\u548cudev\u662f\u4e00\u6837\u7684\uff0c\u7406\u89e3\u4e86udev\uff0c\u4e5f\u5c31\u7406\u89e3\u4e86vold\u3002Android\u7684\u6e90\u4ee3\u7801NetlinkManager.cpp\u540c\u6837\u662f\u76d1\u542c\u57fa\u4e8enetlink\u7684\u5957\u63a5\u5b57\uff0c\u5e76\u89e3\u6790\u6536\u5230\u7684\u6d88\u606f\u3002"))}p.isMDXComponent=!0},92138:function(e,n,t){n.Z=t.p+"assets/images/1742828073298-7aa2dcec5f79ee22f592785cc78fb5e7.png"},4756:function(e,n,t){n.Z=t.p+"assets/images/1742828098508-92989e6b84bde20a5ca2e81d85d98c79.png"}}]);